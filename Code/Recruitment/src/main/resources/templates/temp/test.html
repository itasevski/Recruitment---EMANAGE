<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" style="margin: 0; padding: 0; scroll-behavior: smooth;">

<head>
    <meta charset="UTF-8"/>
    <title>EMANAGE</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>

    <script src="../../static/js/autoscroll.js"></script>

    <link rel="stylesheet" href="../../static/css/font-awesome.min.css">

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="../../static/css/tooplate-style.css">


</head>

<body style="margin: 0; padding: 0;">

<header xmlns:th="http://www.thymeleaf.org">
    <nav class="navbar navbar-dark bg-dark" style="color: #1c2e4a">
        <div class="container">
            <a class="navbar-brand" href="#" style="font-family: Georgia, serif; font-size: 25px">EMANAGE</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault"
                    aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <form class="form-inline my-2 my-lg-0 entitySearch">
                <div class="input-group input-group-sm">
                    <input type="text" class="form-control" aria-label="Small"
                           aria-describedby="inputGroup-sizing-sm"
                           placeholder="Search ads..." name="attrName" id="attrName">
                    <div class="input-group-append">
                        <input class="btn btn-secondary btn-number" type="submit" value="Search"/>
                    </div>
                </div>
            </form>

            <div class="collapse navbar-collapse justify-content-end" id="navbarsExampleDefault">
                <ul class="navbar-nav m-auto nmlist">
                        <li class="nav-item" style="color:whitesmoke;">
                            Ivot2000
                        </li>
                        <li class="nav-item">
                            <button type="button" class="btn btn-success"><i class="fa fa-user"></i>
                                View profile
                            </button>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="btn btn-light"><i class="fa fa-user"></i>
                                Login
                            </button>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="btn btn-primary"><i class="fa fa-user-plus"></i>
                                Sign up
                            </button>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="btn btn-danger"><i class="fa fa-user"></i>
                                Logout
                            </button>
                        </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<section id="feed"
         xmlns:th="http://www.thymeleaf.org"
         xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
    <div class="row">
        <div class="col-md-6 col-xs-12 col-md-offset-3">
            <div class="panel-info">
                <div class="panel-body" th:if="${isCompany}">
                    <h3 class="panel-info">Post an ad</h3>
                </div>
                <div class="panel-body">
                    <form method="post" action="/feed">
                        <th:block th:if="${isCompany}">
                            <div class="form-group">
                                <input class="form-control form-control-lg" type="text" name="header" placeholder="Header" style="margin-bottom: 7px" required>
                                <textarea class="form-control" placeholder="Body" name="body" rows="3" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-info btn-sm pull-right waves-effect waves-light">Post</button>
                        </th:block>
                    </form>
                    <br>
                    <br>
                    <div th:if="${hasError}" class="text-danger" style="font-size: 25px">THE AD YOU SELECTED IS ALREADY SAVED IN YOUR LIST.</div>
                    <div class="panel-heading">
                        <h3 class="panel-title">Jobs/Internships</h3>
                    </div>
                    <label for="sortSelect" style="margin-left: 470px; font-weight: bold; font-size: 18px">Sort by: </label>
                    <select class="form-select" id="sortSelect" name="sortSelect" aria-label="Default select example" style="margin-left: 470px;">
                        <option value="nto">Date (newest to oldest)</option>
                        <option value="otn">Date (oldest to newest)</option>
                        <option value="title">Title</option>
                        <option value="companyName">Company name</option>
                    </select>
                    <div class="clearfix"></div>
                    <hr class="margin-bottom-10">
                    <ul class="list-group list-group-dividered list-group-full">
                        <th:block th:each="ad : ${allAds}">
                            <li class="list-group-item">
                                <div class="media">
                                    <div class="media-left">
                                        <a class="avatar avatar-online" href="javascript:void(0)">
                                            <img th:if="${#request.getRemoteUser() != null}" th:src="${ad.getCompany().getImageSourceUrl()}" alt="...">
                                            <img th:if="${#request.getRemoteUser() == null}" th:src="${defaultProfilePicture}" alt="...">
                                            <i></i>
                                        </a>
                                    </div>
                                    <div class="media-body">
                                        <small class="text-muted pull-right" th:text="${ad.getTimestamp()}"></small>
                                        <h4 class="media-heading" th:text="${ad.getCompany().getName()}"></h4>
                                        <div style="font-size: 20px; font-weight: bold; padding-bottom: 7px;" th:text="'Title: ' + ${ad.getHeader()}"></div>
                                        <div th:text="${ad.getBody()}"></div>
                                        <form method="get" th:action="@{'/feed/person/{id}' (id=${ad.getId()})}">
                                            <th:block sec:authorize="isAuthenticated()" th:if="${isAdmin == null && isCompany == null}">
                                                <button type="submit" name="userButton" value="interested" class="btn btn-outline-info media-bottom" style="margin-top: 12px">I'm interested</button>
                                            </th:block>
                                            <th:block th:if="${isPerson}">
                                                <button type="submit" name="userButton" value="email" class="btn btn-outline-success media-bottom" style="margin-top: 12px">Send e-mail</button>
                                            </th:block>
                                        </form>
                                        <form method="get" th:action="@{'/feed/other/{id}' (id=${ad.getId()})}">
                                            <th:block th:if="${ad.getCompany().getId() == #request.getRemoteUser() || isAdmin == true}">
                                                <button type="submit" name="otherButton" value="delete" class="btn btn-outline-danger media-bottom" style="margin-top: 12px">Delete</button>
                                            </th:block>
                                            <th:block th:if="${ad.getCompany().getId() == #request.getRemoteUser()}">
                                                <button type="submit" name="otherButton" value="edit" class="btn btn-outline-dark media-bottom" style="margin-top: 12px">Edit</button>
                                            </th:block>
                                        </form>
                                    </div>
                                </div>
                            </li>
                            <br/>
                        </th:block>
                    </ul>
                    <br>
                    <span class="text-info" style="" th:text="${numActiveUsers} + ' active users'"></span>
                </div>
            </div>
        </div>
    </div>
</section>


<footer id="footer" data-stellar-background-ratio="0.5" style="height: 95px;">
    <div class="container" style="background-color: white">
        <div class="row" style="margin-left: 350px;">
            <div class="copyright-text col-md-12 col-sm-12">
                <div class="col-md-6 col-sm-6">
                    <p style="margin-top: 15px">Copyright &copy; 2021 EMANAGE</p>
                </div>

                <div class="col-md-6 col-sm-6">
                    <ul class="social-icon" style="margin-top: 5px;">
                        <li><a href="#" class="fa fa-facebook-square" attr="facebook icon"></a></li>
                        <li><a href="#" class="fa fa-twitter"></a></li>
                        <li><a href="#" class="fa fa-instagram"></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- SCRIPTS -->
<script src="../../static/js/jquery.js"></script>
<script src="../../static/js/bootstrap.min.js"></script>
<script src="../../static/js/jquery.stellar.min.js"></script>
<script src="../../static/js/owl.carousel.min.js"></script>
<script src="../../static/js/smoothscroll.js"></script>
<script src="../../static/js/custom.js"></script>

</body>

</html>